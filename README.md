# toiletManage
廊坊旅游公厕微信小程序

# 介绍
该项目为政府项目，为响应习近平总书记新三年“厕所革命”的重要指示。提升廊坊旅游公厕建设和管理水平，全面展示廊坊旅游形象，进一步完善全域旅游创建厕所革命智慧化进程，根据2018年工作计划，拟为全市20座AA级以上旅游厕所进行“互联网+廊坊旅游厕所”智慧化提升服务，通过软硬件系统集成，实现廊坊旅游公厕智能化管理。打造智慧公厕，提高公共厕所的管理水平，建设现代化城市。我们综合利用最新物联网、云计算、通信技术等技术，整合现有资源，创建公厕管理数据库，实现对入厕流量检测、蹲位检测、报修，导航等智能化远程管理，达到环卫公厕管理与互联网技术的完美融合。
项目名称：廊坊旅游厕所智慧管理系统提升项目。
https://www.sohu.com/a/271243037_786805
# 使用说明
环境要求：操作系统为windows 10/linux
安装软件：VS code，微信小程序开发工具，node，npm，MySQL
## 管理后台
- mySQL 中导入sql文件 toiletManage\管理后台\smart_city_toilet.sql
- cd 管理后台/
- npm install
- npm run dev
- 在http://localhost:8080/#/ 可以看到启动后的界面
- 线上环境：https://88889889.xyz/admin
- 用户名：admin
- 密码：admin
- 微信小程序搜索：廊坊旅游找厕所
## 小程序客户端

微信小程序开发工具直接导入小程序客户端代码即可

# 技术
- 客户端：采用微信小程序API，ES6，CSS3，h5，腾讯地图api等技术，主要实现厕所路线推荐，评价 ，报修，添加，导航等功能。
- 管理后台：主要采用vue+wepack+ElementUI构建项目，HTTP，express 框架MySQL搭建服务器，采用前后端分离模式开发，主要实现功能表格分页，登录，退出，评价管理，报修管理，选项修改等等

# 开发细节
比如说登陆
## 需求
在登录界面上实现管理员输入账号密码，点击【登录】，获取用户输入用户名，密码，发送http请求，查询数据库，如果账号不存在，如果账号存在，判断密码是否正确，正确保存用户名密码到本地，跳转到登陆页面，密码错误则提示密码错误。如果未登录直接访问需要登陆的页面，重定向到登陆页面，如果已登录，跳转到访问页面，如图6-1为登录界面。
## 实现思路
- 1.连接数据库，需要数据库名字，用户名，密码。
- 2.路由获取访问url，如果是‘/’，通过session判断是否登陆，未登录，重定向到登陆页面，已登录，重定向到首页。
- 3.用户访问login页面，点击登陆后，查询数据库，判断账号是否存在，不存在提示账号不存在，存在再判断密码是否正确，如果正确保存用户名，密码到session中，改为登陆状态，然后跳转到后台首页
## 小程序开发
点击【添加】，跳转到转到厕所添加页面。页面主要信息有厕所的名称、唯一标识sn(整数，0表示普通厕所，其它数字表示智慧厕所)、上传照片(至少一张)，输入完整并且验证通过后会出现【提交】按钮(默认隐藏)，点击【提交】，如果提交成功跳转到感谢页面，同时发送http请求更新数据库。管理后台就可以查看到新上报的厕所。点击【完成】，返回到首页，首页的地图以及周边厕所上也会显示新上报的厕所